<!DOCTYPE html><html lang=en-US><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Text Language Translation Utility | Keystroke Countdown</title><meta name=author content="[object Object]"><meta name=robots content="index, follow"><meta name=HandheldFriendly content=True><meta name=description content="Brief discussion of Node.js utility I use on macOS to translate text between French and English"><link rel=author href=/humans.txt><link rel=icon type=image/png href=/images/favicon.png><link rel=stylesheet href=/css/all-219136742a6fdee2bdc61d07f9ed89cc.css></head><body class="post-template nav-closed"><div class="nav nav-closed" id=nav><h3 class=nav-title>Menu</h3><a href=# class=nav-close><span class=hidden>Close</span></a><ul class=nav-list><li class=nav-home role=presentation><a href=/ ><i class="fa fa-home" aria-hidden=true></i> Home</a></li><li class=nav-home role=presentation><a href=/about><i class="fa fa-info-circle" aria-hidden=true></i> About Me</a></li><li class=nav-nome role=presentation><a href=/rss.xml><i class="fa fa-rss" aria-hidden=true></i> Subscribe</a> <a href="https://validator.w3.org/feed/check.cgi?url=https%3A//keystrokecountdown.com/rss.xml"><img src=/images/valid-rss-rogers.png alt="[Valid RSS]" title="Validate my RSS feed"></a></li><li class=nav-home role=presentation><a href=/topics><i class="fa fa-tags" aria-hidden=true></i> Topics</a></li><br><li class=nav-home role=presentation><a href=/articles/auv3/index.html>AUv3 Development -- Part 1 of N</a></li><li class=nav-home role=presentation><a href=/articles/knobci/index.html>Swift Snapshot Testing in Github Actions</a></li><li class=nav-home role=presentation><a href=/articles/wma/index.html>Converting WMA Files to MP3</a></li><li class=nav-home role=presentation><a href=/articles/remarkable/index.html>Remarkable Customizations</a></li><li class=nav-home role=presentation><a href=/articles/browsers/index.html>Automatic Browser Selection</a></li><li class=nav-home role=presentation><a href=/articles/genart/index.html>Generative Images with SVG.js</a></li><li class=nav-home role=presentation><a href=/articles/logistic/index.html>Simple Image Classification using Logistic Regression</a></li><li class=nav-home role=presentation><a href=/articles/kerberos/index.html>Using Kerboros on macOS</a></li><li class=nav-home role=presentation><a href=/articles/translate/index.html>Text Language Translation Utility</a></li><li class=nav-home role=presentation><a href=/articles/keymaps/index.html>Remapping Keys on macOS High Sierra</a></li><li class=nav-home role=presentation><a href=/articles/letencrypt/index.html>Fixing Azure Let&#x27;s Encrypt Expired Key</a></li><li class=nav-home role=presentation><a href=/articles/console/index.html>Formatting Console Output</a></li><li class=nav-home role=presentation><a href=/articles/layout/index.html>[DRAFT] Test Page for CSS Settings</a></li><li class=nav-home role=presentation><a href=/articles/docker/index.html>[DRAFT] Playing with .Net Core Apps and Docker on a Mac</a></li><li class=nav-home role=presentation><a href=/articles/autohotkey/index.html>Different (Key)strokes for Different Folks</a></li><li class=nav-home role=presentation><a href=/articles/itunes/index.html>Apple iTunes Library Manipulation with Python</a></li><li class=nav-home role=presentation><a href=/articles/metalsmith2/index.html>Metalsmith Plugins for Server-side KaTeX Processing</a></li><li class=nav-home role=presentation><a href=/articles/poisson/index.html>Arrival Intervals of a Poisson Process</a></li><li class=nav-home role=presentation><a href=/articles/cocoapods/index.html>Framework Bundles in Xcode and CocoaPods</a></li><li class=nav-home role=presentation><a href=/articles/signing/index.html>Signing Embedded Frameworks in an Embedded Framework</a></li><li class=nav-home role=presentation><a href=/articles/vhtc/index.html>Variable Height UITableView Cells in Swift</a></li><li class=nav-home role=presentation><a href=/articles/joystick/index.html>JoyStickView for iOS in Swift</a></li><li class=nav-home role=presentation><a href=/articles/dependencyInjection/index.html>Dependency Injection for iOS in Swift</a></li><li class=nav-home role=presentation><a href=/articles/corePlot/index.html>Working with Core Plot</a></li><li class=nav-home role=presentation><a href=/articles/slidingViews/index.html>Sliding UIViews with Core Animation</a></li><li class=nav-home role=presentation><a href=/articles/swiftCollection/index.html>Adding Binary Search to Swift Collections</a></li><li class=nav-home role=presentation><a href=/articles/metalsmith/index.html>Metalsmith Static Site on Azure</a></li><li class=nav-home role=presentation><a href=/articles/bloom/index.html>Bloom Filters in Python</a></li><li class=nav-home role=presentation><a href="/articles/Testing IPython/testing-ipython.html">Testing IPython</a></li><li class=nav-home role=presentation><a href=/articles/decrypt/index.html>Decrypting Logs in Python</a></li><li class=nav-home role=presentation><a href=/articles/power/index.html>Power of Optimal Algorithm Design</a></li><li class=nav-home role=presentation><a href=/articles/PDMPlayground/index.html>PDM Playground</a></li><li class=nav-home role=presentation><a href=/articles/bscope/index.html>B-Scope Radar Display</a></li><li class=nav-home role=presentation><a href=/articles/ascope/index.html>A-Scope Signal Display</a></li><li class=nav-home role=presentation><a href=/articles/radardisplay/index.html>Radar Display</a></li><li class=nav-home role=presentation><a href=/articles/dfwtraffic/index.html>Visualizing Traffic at DFW Airport</a></li></ul></div><span class=nav-cover></span><div class=site-wrapper><header class="main-header post-head" style="background-image: url(/articles/translate/translate.png)"><nav class="main-nav overlay clearfix"><a class="menu-button icon-menu" href=#><span class=word>Menu</span></a></nav></header><main class=content role=main><article class=post><header class=post-header><h1 class=post-title><a href=/ >Text Language Translation Utility</a></h1><section class=post-meta><time class=post-date datetime="Mon Aug 13 2018 13:18:02 GMT+0200 (Central European Summer Time)">Aug 13th, 2018</time> <a class=post-date href=/topics><i class="fa fa-tags" aria-hidden=true></i></a> <a class=post-date href=/topics/google.html>Google (1)</a> • <a class=post-date href=/topics/keyboard-maestro.html>Keyboard Maestro (1)</a> • <a class=post-date href=/topics/node.js.html>Node.js (1)</a></section></header><section class=post-content><p>Ever since moving to Europe back in 2010, I have been a dedicated user of <a href=https://translate.google.com>Google Translate</a>. However, cutting-and-pasting between a web site or text document and the Translate’s input field is a bit tedious, so I looked into ways to make it easier to integrate into my daily life on a laptop. The solution I came up with relies on <a href=https://nodejs.org>Node.js</a>, the NPM package <a href=https://www.npmjs.com/package/google-translate-api>google-translate-api</a>, and the excellent macOS utility called <a href=https://www.keyboardmaestro.com/main/ >Keyboard Maestro</a>.</p><h1>Getting Started with Translations</h1><p>A quick search for libraries/packages that integrates with Google Translate led me to the <a href=https://www.npmjs.com/package/google-translate-api>google-translate-api</a>. A short bit later, I had a simple Node.js program that does the job:</p><pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> process <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'process'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> translate <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'google-translate-api'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Read stdin, translate it, write to /dev/stdout</span>
<span class="token comment">//</span>
<span class="token keyword">const</span> sourceLanguage <span class="token operator">=</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> targetLanguage <span class="token operator">=</span> process<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> text <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'/dev/stdin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">translate</span><span class="token punctuation">(</span>text<span class="token punctuation">,</span> <span class="token punctuation">{</span>from<span class="token operator">:</span> sourceLanguage<span class="token punctuation">,</span> to<span class="token operator">:</span> targetLanguage<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>Nothing fancy – just read in some text to translate and direct Google Translate to do the hard work. When we get the response from Google, send the output text to stdout for another process to read. We can quickly check that it works:</p><pre class=language-console><code class=language-console><span class=command-line-prompt><span data-prompt=%></span><span data-prompt=" "></span></span><span class=command-line-command>echo 'The king is dead. Long live the king' | node translate.js en fr</span>
Le roi est mort. Longue vie au roi.</code></pre><p>Seems ok. Let’s try the reverse for fun:</p><pre class=language-console><code class=language-console><span class=command-line-prompt><span data-prompt=%></span><span data-prompt=" "></span></span><span class=command-line-command>echo 'Le roi est mort. Longue vie au roi.' | node translate.js fr en</span>
The king is dead. Long live the king.</code></pre><h1>Bring in the Keyboard Maestro</h1><p>Next step is to hook the <code>translate.js</code> utility to run when I press a specific key sequence after selecting some text. First, I created two Keyboard Maestro macros for the two translation paths: English to French, and French to English.</p><p><img src=EnglishFrench_960.png title="" srcset="EnglishFrench_480.png 480w,EnglishFrench_650.png 650w,EnglishFrench_960.png 960w,EnglishFrench_1440.png 1440w" sizes="(min-width: 960px) 960px, calc(100vw-6rem)"></p><p>The only difference is the order of the <code>en</code> and <code>fr</code> arguments given to <code>translate.js</code>.</p><p><img src=FrenchEnglish_960.png title="" srcset="FrenchEnglish_480.png 480w,FrenchEnglish_650.png 650w,FrenchEnglish_960.png 960w,FrenchEnglish_1440.png 1440w" sizes="(min-width: 960px) 960px, calc(100vw-6rem)"></p><p>The macros read whatever text is in the <strong>System Clipboard</strong> and passes it to the <code>translate.js</code> script being run in a Node.js process. Keyboard Maestro reads the output of the Node.js process and puts it into the <strong>System Clipboard</strong>, replacing the text that was there with its translation.</p><p>Both macros are configured to appear in the <em>global macro palette</em>. The global macro palette will appear when a key sequence is pressed, which in my setup is the function key <code>F12</code>.</p><p><img src=ShowPalette_960.png title="" srcset="ShowPalette_480.png 480w,ShowPalette_650.png 650w,ShowPalette_960.png 960w,ShowPalette_1440.png 1440w" sizes="(min-width: 960px) 960px, calc(100vw-6rem)"></p><p>Now, pressing <code>F12</code> brings up a small palette with two choices:</p><p><img src=PaletteWindow_960.png title="" srcset="PaletteWindow_480.png 480w,PaletteWindow_650.png 650w,PaletteWindow_960.png 960w,PaletteWindow_1440.png 1440w" sizes="(min-width: 960px) 960px, calc(100vw-6rem)"></p><p>Pressing the letter <code>E</code> will bring about the English-French translation, while pressing <code>F</code> will translate French to English. Simple. Here is what the translation output looks like:</p><p><img src=Demo_960.png title="" srcset="Demo_480.png 480w,Demo_650.png 650w,Demo_960.png 960w,Demo_1440.png 1440w" sizes="(min-width: 960px) 960px, calc(100vw-6rem)"></p><h1>Postscript</h1><p>After writing this up, I wondered if there was perhaps a macOS Services menu item which would do much the same as what I did above. I found on Github <a href=https://github.com/dbmrq/workflow-translate>workflow-translate</a> which appears to do something similar (I have not tested it). The bottom of the README there points to a Medium article called <a href=https://medium.com/@mrdoro/fast-translation-with-google-translator-and-mac-osx-817e32233b7a>Fast translation with Google Translator and MAC OSX</a> which describes how to get Automator to do the translating work. However, it looks like the translated results appears in a Safari window. I prefer the minimal interface provided by Keyboard Maestro.</p></section><footer class=post-footer><figure class=author-image><a class=img href=https://keystrokecountdown.com style=background-image:url(/images/HarrisonsLaugh.png)><span class=hidden>Brad Howes's Picture</span></a></figure><section class=author><h4><a href=https://keystrokecountdown.com>Brad Howes</a></h4><p>Owner <a href=https://apps.apple.com/us/developer/b-ray-software/id430573224>B-Ray Software</a>. Programmer in C++, Swift, Python, Javascript and more. Started out doing punch cards in FORTRAN.</p><div class=author-meta><span class="author-location icon-location">Paris, France</span> <span class="author-link icon-link"><a href=http://linkedin.com/in/bradhowes>http://linkedin.com/in/bradhowes</a></span> <span class="author-link icon-feed"><a href=mailto:bradhowes@mac.com>&nbsp;Email Me</a></span></div></section><section class=share><h4>Share this page</h4><div class=social-icons><a class=icon-twitter href="https://twitter.com/intent/tweet?text=Text%20Language%20Translation%20Utility&amp;url=https%3A%2Fkeystrokecountdown.com%2Farticles%2Ftranslate%2Findex.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"><span class=hidden>Twitter</span> </a><a class=icon-feed href="mailto:bradhowes@mac.com?subject=Curiosity&body=https%3A%2Fkeystrokecountdown.com%2Farticles%2Ftranslate%2Findex.html"><span class=hidden>Email</span></a></div></section></footer></article></main><aside class=read-next><a class=read-next-story style="background-image: url(/images/computer-keyboard-stones-on-grass-background-header.jpg)" href=/articles/keymaps/index.html><section class=post><h2>Remapping Keys on macOS High Sierra</h2><div class=post-meta>Short discussion on how I remapped the keys on my MacBook Pro w/ an international layout.</div></section></a><a class="read-next-story prev" style="background-image: url(/articles/kerberos/Kerberos.png)" href=/articles/kerberos/index.html><section class=post><h2>Using Kerboros on macOS</h2><div class=post-meta>A post to help me remember some Kerberos commands</div></section></a></aside><footer class="site-footer clearfix"><section class=copyright><a href=https://keystrokecountdown.com>Keystroke Countdown</a> &copy; <span id=copyrightYear>2018</span> Brad Howes — <a href=https://github.com/bradhowes/keystrokecountdown>Source</a></section></footer></div><script>(function () {
      var installClickHandlers = function () {
        var navElement = document.getElementById("nav");
    
        // The click handler just toggles classes to do the showing/hiding
        //
        var clickHandler = function(e) {
          document.body.classList.toggle("nav-opened");
          document.body.classList.toggle("nav-closed");
          if (navElement) {
            navElement.classList.toggle("nav-opened");
            navElement.classList.toggle("nav-closed");
          }
        };
    
        // Find elements we wish to tap for click events
        //
        var elements = Array.prototype.slice.call(
          document.querySelectorAll(".menu-button, .nav-cover, .nav-close"));
        if (elements && elements.length > 0) {
          elements.forEach(function (element) {
            element.addEventListener('click', clickHandler);
          });
        }
      };
    
      // When the document is finished loading, install event handlers to show/hide sidebar menu
      //
      window.document.addEventListener("DOMContentLoaded", function (event) {
        installClickHandlers();
    
        // Set the copyright year at the bottom of our pages
        //
        window.document.getElementById("copyrightYear").innerHTML = (new Date()).getFullYear();
      });
    })();</script></body></html>