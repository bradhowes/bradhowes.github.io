<!DOCTYPE html><html lang=en-US><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><title>Different (Key)strokes for Different Folks | Keystroke Countdown</title><meta name=author content="[object Object]"><meta name=robots content="index, follow"><meta name=HandheldFriendly content=True><meta name=description content="Short discussion on how I configured AutoHotKey to minimize my typing errors in Windows."><link rel=author href=/humans.txt><link rel=icon type=image/png href=/images/favicon.png><link rel=stylesheet href=/css/all-219136742a6fdee2bdc61d07f9ed89cc.css></head><body class="post-template nav-closed"><div class="nav nav-closed" id=nav><h3 class=nav-title>Menu</h3><a href=# class=nav-close><span class=hidden>Close</span></a><ul class=nav-list><li class=nav-home role=presentation><a href=/ ><i class="fa fa-home" aria-hidden=true></i> Home</a></li><li class=nav-home role=presentation><a href=/about><i class="fa fa-info-circle" aria-hidden=true></i> About Me</a></li><li class=nav-nome role=presentation><a href=/rss.xml><i class="fa fa-rss" aria-hidden=true></i> Subscribe</a> <a href="https://validator.w3.org/feed/check.cgi?url=https%3A//keystrokecountdown.com/rss.xml"><img src=/images/valid-rss-rogers.png alt="[Valid RSS]" title="Validate my RSS feed"></a></li><li class=nav-home role=presentation><a href=/topics><i class="fa fa-tags" aria-hidden=true></i> Topics</a></li><br><li class=nav-home role=presentation><a href=/articles/auv3/index.html>AUv3 Development -- Part 1 of N</a></li><li class=nav-home role=presentation><a href=/articles/knobci/index.html>Swift Snapshot Testing in Github Actions</a></li><li class=nav-home role=presentation><a href=/articles/wma/index.html>Converting WMA Files to MP3</a></li><li class=nav-home role=presentation><a href=/articles/remarkable/index.html>Remarkable Customizations</a></li><li class=nav-home role=presentation><a href=/articles/browsers/index.html>Automatic Browser Selection</a></li><li class=nav-home role=presentation><a href=/articles/genart/index.html>Generative Images with SVG.js</a></li><li class=nav-home role=presentation><a href=/articles/logistic/index.html>Simple Image Classification using Logistic Regression</a></li><li class=nav-home role=presentation><a href=/articles/kerberos/index.html>Using Kerboros on macOS</a></li><li class=nav-home role=presentation><a href=/articles/translate/index.html>Text Language Translation Utility</a></li><li class=nav-home role=presentation><a href=/articles/keymaps/index.html>Remapping Keys on macOS High Sierra</a></li><li class=nav-home role=presentation><a href=/articles/letencrypt/index.html>Fixing Azure Let&#x27;s Encrypt Expired Key</a></li><li class=nav-home role=presentation><a href=/articles/console/index.html>Formatting Console Output</a></li><li class=nav-home role=presentation><a href=/articles/layout/index.html>[DRAFT] Test Page for CSS Settings</a></li><li class=nav-home role=presentation><a href=/articles/docker/index.html>[DRAFT] Playing with .Net Core Apps and Docker on a Mac</a></li><li class=nav-home role=presentation><a href=/articles/autohotkey/index.html>Different (Key)strokes for Different Folks</a></li><li class=nav-home role=presentation><a href=/articles/itunes/index.html>Apple iTunes Library Manipulation with Python</a></li><li class=nav-home role=presentation><a href=/articles/metalsmith2/index.html>Metalsmith Plugins for Server-side KaTeX Processing</a></li><li class=nav-home role=presentation><a href=/articles/poisson/index.html>Arrival Intervals of a Poisson Process</a></li><li class=nav-home role=presentation><a href=/articles/cocoapods/index.html>Framework Bundles in Xcode and CocoaPods</a></li><li class=nav-home role=presentation><a href=/articles/signing/index.html>Signing Embedded Frameworks in an Embedded Framework</a></li><li class=nav-home role=presentation><a href=/articles/vhtc/index.html>Variable Height UITableView Cells in Swift</a></li><li class=nav-home role=presentation><a href=/articles/joystick/index.html>JoyStickView for iOS in Swift</a></li><li class=nav-home role=presentation><a href=/articles/dependencyInjection/index.html>Dependency Injection for iOS in Swift</a></li><li class=nav-home role=presentation><a href=/articles/corePlot/index.html>Working with Core Plot</a></li><li class=nav-home role=presentation><a href=/articles/slidingViews/index.html>Sliding UIViews with Core Animation</a></li><li class=nav-home role=presentation><a href=/articles/swiftCollection/index.html>Adding Binary Search to Swift Collections</a></li><li class=nav-home role=presentation><a href=/articles/metalsmith/index.html>Metalsmith Static Site on Azure</a></li><li class=nav-home role=presentation><a href=/articles/bloom/index.html>Bloom Filters in Python</a></li><li class=nav-home role=presentation><a href="/articles/Testing IPython/testing-ipython.html">Testing IPython</a></li><li class=nav-home role=presentation><a href=/articles/decrypt/index.html>Decrypting Logs in Python</a></li><li class=nav-home role=presentation><a href=/articles/power/index.html>Power of Optimal Algorithm Design</a></li><li class=nav-home role=presentation><a href=/articles/PDMPlayground/index.html>PDM Playground</a></li><li class=nav-home role=presentation><a href=/articles/bscope/index.html>B-Scope Radar Display</a></li><li class=nav-home role=presentation><a href=/articles/ascope/index.html>A-Scope Signal Display</a></li><li class=nav-home role=presentation><a href=/articles/radardisplay/index.html>Radar Display</a></li><li class=nav-home role=presentation><a href=/articles/dfwtraffic/index.html>Visualizing Traffic at DFW Airport</a></li></ul></div><span class=nav-cover></span><div class=site-wrapper><header class="main-header post-head" style="background-image: url(/articles/autohotkey/banner.png)"><nav class="main-nav overlay clearfix"><a class="menu-button icon-menu" href=#><span class=word>Menu</span></a></nav></header><main class=content role=main><article class=post><header class=post-header><h1 class=post-title><a href=/ >Different (Key)strokes for Different Folks</a></h1><section class=post-meta><time class=post-date datetime="Mon Oct 09 2017 11:06:00 GMT+0200 (Central European Summer Time)">Oct 9th, 2017</time> <a class=post-date href=/topics><i class="fa fa-tags" aria-hidden=true></i></a> <a class=post-date href=/topics/autohotkey.html>AutoHotKey (1)</a> • <a class=post-date href=/topics/emacs.html>Emacs (1)</a> • <a class=post-date href=/topics/windows.html>Windows (1)</a></section></header><section class=post-content><p>I have been a programmer for nearly 40 years, and in all of that time I never really had to use a computer running Windows. Even after Microsoft bought Skype in 2011, I was able to perform my day-to-day tasks on a MacBook Pro 17&quot; that I originally received when I joined Skype in 2010. I did give Windows a shot on a lovely ASUS notebook I received after the sale, but the trackpad performance was so awful I gave up after a month or two and went back to my original MacBook Pro.</p><p>Now I find myself coding in C# within Visual Studio 2017 and there is no easy way to get around being in a Windows environment. This time there is no trackpad to irritate me – instead, it is my stubborn muscle memory that I have acquired over those 30+ years while writing code in Emacs. I am so used to keeping my fingers on the home-row of a keyboard that even using arrow keys is a major nuisance; it just slows me down. In my humble opinion, one of the greatest decisions someone at Apple made was to support some of the Emacs key sequences in Mac OS X text fields for cursor movement and text editing. I suspect quite a few others feel the same way, especially those who came from a Unix background as I did.</p><h2>The Emacs Way</h2><p>Emacs has a pretty simple model for moving a cursor around in a buffer of text:</p><ul><li><em>^B</em> - move the cursor <em>back</em> one character</li><li><em>^F</em> - move the cursor <em>forward</em> one character</li><li><em>^A</em> - move cursor to the beginning of the current line (think of <em>A</em> in <em>A–Z</em>)</li><li><em>^E</em> - move cursor to the <em>end</em> of the current line</li><li><em>^P</em> - move up to <em>previous</em> line</li><li><em>^N</em> - move down to <em>next</em> line</li></ul><p>(here, <strong>^</strong> means to hold down the Control modifier on the keyboard while pressing the next character)</p><p>Although some have reportedly developed an affliction known as <em>Emacs Pinkie</em>, I have not. And I use these control sequences many, many, many times a day – so much in fact that I naturally and effortlessly press <em>^B</em> when I wish to move a cursor backwards in a sentence, only to discover that <strong>this does not work in Windows</strong>!</p><h2>The AutoHotKey Way</h2><p>During my brief excursion into Windows on the ASUS laptop, I learned about a neat and powerful utility called <a href=https://autohotkey.com>AutoHotKey</a> that pretty much let’s you reconfigure your keyboard (and more) as you want. There is a big community of AutoHotKey users and there are a lot of examples available from various sites that show you how to do various amazing things with AutoHotKey. For instance, I found several configurations which promised some semblance of Emacs keystroke emulation. Unfortunately I encountered errors in some of them which were difficult to debug due to my complete ignorance of all things AutoHotKey. Instead, I decided to write my own, short version that would get me Emacs-like cursor motion and some editing, while at the same time letting me use the plethora of keyboard shortcuts in Visual Studio 2017 (of which I know perhaps 2 by heart).</p><p>Having the cursor move like I want was surprisingly easy. Here, I convert from a control character (e.g. <em>^B</em>) to a native Windows key (here, <em>{Left}</em> means the left arrow key). The <code>DoMove</code> function I will get to in a second:</p><pre class=language-autohotkey><code class=language-autohotkey><span class="token operator">^</span>b<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Left}"</span><span class="token punctuation">)</span>    <span class="token comment">; Previous character</span>
<span class="token operator">^</span>f<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Right}"</span><span class="token punctuation">)</span>   <span class="token comment">; Next character</span>
<span class="token operator">^</span>a<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Home}"</span><span class="token punctuation">)</span>    <span class="token comment">; Beginning of line</span>
<span class="token operator">^</span>e<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{End}"</span><span class="token punctuation">)</span>     <span class="token comment">; End of line</span>
<span class="token operator">^</span>p<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Up}"</span><span class="token punctuation">)</span>      <span class="token comment">; Previous line</span>
<span class="token operator">^</span>n<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Down}"</span><span class="token punctuation">)</span>    <span class="token comment">; Next line</span>
</code></pre><p>Two more very common Emacs keystrokes for me are <em>^K</em> which will erase all characters from the cursor to the end of the line; and <em>^D</em> which erases the character ahead of the cursor.</p><p>To simulate these two using normal Windows keystrokes gives the following:</p><pre class=language-autohotkey><code class=language-autohotkey><span class="token operator">^</span>k<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoEdit</span><span class="token punctuation">(</span><span class="token string">"+{End}^x"</span><span class="token punctuation">)</span>  <span class="token comment">; Kill line</span>
<span class="token operator">^</span>d<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoEdit</span><span class="token punctuation">(</span><span class="token string">"{Delete}"</span><span class="token punctuation">)</span>  <span class="token comment">; Delete next character</span>
</code></pre><p>Here, a <em>^K</em> results in two Windows keys: the <em>End</em> key with the <em>Shift</em> modifier pressed down, followed by a <em>^X</em>: the first key selects the text from the cursor to the end of the line, and the second key causes a <em>cut</em> operation which removes the selected text and puts it into the clipboard for future <em>pasting</em>.</p><h2>Methods of Madness</h2><p>The <code>DoMove</code> and <code>DoEdit</code> tags above refer to AutoHotKey functions. They both take one argument, which is a keystroke sequence to generate to replace the one that the user originally typed. They perform nearly the same action – in fact they both end up calling the same function, <code>DoSend</code>, to actually do some work. The <code>DoSend</code> method is shown below in full:</p><pre class=language-autohotkey><code class=language-autohotkey><span class="token comment">; If previous hotkey was Control-Return, then just echo the active hotkey</span>
<span class="token comment">; Otherwise, issue the given key sequence, possibly with a shift modifier if</span>
<span class="token comment">; we are selecting text.</span>
<span class="token function">DoSend</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">A_PriorHotKey</span> <span class="token operator">==</span> <span class="token string">"$^Return"</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">A_TimeSincePriorHotKey</span> <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token selector">Send</span><span class="token punctuation">,</span> <span class="token variable">%A_ThisHotKey%</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectMode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token selector">Send</span><span class="token punctuation">,</span> <span class="token operator">+</span><span class="token variable">%key%</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token selector">Send</span><span class="token punctuation">,</span> <span class="token variable">%key%</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>The first conditional is true if the previous key sequence handled by AutoHotKey was a <em>Control-Return</em> and it was seen less than 1 second ago. I use <em>^Return</em> as a way to signal AutoHotKey to <strong>not</strong> translate the next keystroke. For instance, typing <em>^Return</em> <em>^A</em> results in AutoHotKey sending <em>^A</em> to the active application, and not the <em>Home</em> keystroke it normally would.</p><p>The second <em>if</em> clause will be true if the <code>selectMode</code> flag is non-zero. This flag is a coarse replica of Emacs’ selection mode which is enabled via <em>^Space</em>. When this flag is non-zero, all movement keys have a phantom <em>Shift</em> key pressed which causes Windows to select text. The <code>selectMode</code> flag is cleared when the <code>DoEdit</code> function executes (this is actually the only difference between it and the <code>DoMove</code> method)</p><p>Finally, the last clause will be invoked if the first two are false. This simply sends the given keystroke to Windows where the active application will see it and process it.</p><h2>Native Emacs Processing</h2><p>Since I can and do also run a native Emacs process I need a way to <em>not</em> filter keys when it is the active window. A one liner in the AutoHotKey configuration file does that for me:</p><pre class=language-autohotkey><code class=language-autohotkey><span class="token important">#If</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token builtin">WinActive</span><span class="token punctuation">(</span><span class="token string">"ahk_class Emacs"</span><span class="token punctuation">)</span> or <span class="token builtin">WinActive</span><span class="token punctuation">(</span><span class="token string">"ahk_class mintty"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><p>It also keeps out Emacs translations when there is a Cygwin terminal window active.</p><h2>Accented Characters</h2><p>Sometime during my stay in Prague, I developed a custom keyboard mapping for my MacBook Pro using the <a href="http://scripts.sil.org/cms/scripts/page.php?site_id=nrsi&amp;id=ukelele">Ukulele</a> utility. My custom map allowed me to easily enter diacritic characters found in the Czech language, in addition to the accented characters of Latin languages that were already available natively in Mac OS X. As far as I know, entering characters with diacritical markings in stock Windows 7 is not at all easy, requiring memorization of various numbers to be entered on a number pad. I created something similar in AutoHotKey. Here’s the complete part first; I’ll break it down later:</p><pre class=language-autohotkey><code class=language-autohotkey><span class="token comment">; Lookup tables from AHK key descriptors to unicode values</span>
<span class="token comment">;                            à À           á Á           ä Ä           â Â</span>
<span class="token keyword">global</span> aMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#VKC0SC029"</span><span class="token punctuation">:</span> <span class="token number">0x00E0</span><span class="token punctuation">,</span> <span class="token string">"#e"</span><span class="token punctuation">:</span> <span class="token number">0x00E1</span><span class="token punctuation">,</span> <span class="token string">"#u"</span><span class="token punctuation">:</span> <span class="token number">0x00E4</span><span class="token punctuation">,</span> <span class="token string">"#i"</span><span class="token punctuation">:</span> <span class="token number">0x00E2</span><span class="token punctuation">}</span>
<span class="token comment">;                            è È           é É           ë Ë           ê Ê</span>
<span class="token keyword">global</span> eMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#VKC0SC029"</span><span class="token punctuation">:</span> <span class="token number">0x00E8</span><span class="token punctuation">,</span> <span class="token string">"#e"</span><span class="token punctuation">:</span> <span class="token number">0x00E9</span><span class="token punctuation">,</span> <span class="token string">"#u"</span><span class="token punctuation">:</span> <span class="token number">0x00EB</span><span class="token punctuation">,</span> <span class="token string">"#i"</span><span class="token punctuation">:</span> <span class="token number">0x00EA</span><span class="token punctuation">}</span>
<span class="token comment">;                            ì Ì           í Í           ï Ï           î Î</span>
<span class="token keyword">global</span> iMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#VKC0SC029"</span><span class="token punctuation">:</span> <span class="token number">0x00EC</span><span class="token punctuation">,</span> <span class="token string">"#e"</span><span class="token punctuation">:</span> <span class="token number">0x00ED</span><span class="token punctuation">,</span> <span class="token string">"#u"</span><span class="token punctuation">:</span> <span class="token number">0x00EF</span><span class="token punctuation">,</span> <span class="token string">"#i"</span><span class="token punctuation">:</span> <span class="token number">0x00EE</span><span class="token punctuation">}</span>
<span class="token comment">;                            ò Ò           ó Ó           ö Ö           ô Ô</span>
<span class="token keyword">global</span> oMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#VKC0SC029"</span><span class="token punctuation">:</span> <span class="token number">0x00F2</span><span class="token punctuation">,</span> <span class="token string">"#e"</span><span class="token punctuation">:</span> <span class="token number">0x00F3</span><span class="token punctuation">,</span> <span class="token string">"#u"</span><span class="token punctuation">:</span> <span class="token number">0x00F6</span><span class="token punctuation">,</span> <span class="token string">"#i"</span><span class="token punctuation">:</span> <span class="token number">0x00F4</span><span class="token punctuation">}</span>
<span class="token comment">;                            ù Ù           ú Ú           ü Ü           û Û</span>
<span class="token keyword">global</span> uMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#VKC0SC029"</span><span class="token punctuation">:</span> <span class="token number">0x00F9</span><span class="token punctuation">,</span> <span class="token string">"#e"</span><span class="token punctuation">:</span> <span class="token number">0x00FA</span><span class="token punctuation">,</span> <span class="token string">"#u"</span><span class="token punctuation">:</span> <span class="token number">0x00FC</span><span class="token punctuation">,</span> <span class="token string">"#i"</span><span class="token punctuation">:</span> <span class="token number">0x00FB</span><span class="token punctuation">}</span>
<span class="token comment">;                    ñ Ñ</span>
<span class="token keyword">global</span> nMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#n"</span><span class="token punctuation">:</span> <span class="token number">0x00F1</span><span class="token punctuation">}</span>

<span class="token comment">; Dead keys - don't do anything until something else is typed (VKC0SC029 is the keycode for a back quote)</span>
<span class="token comment">;</span>
#VKC0SC029<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Return</span>      <span class="token comment">; grave</span>
#e<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Return</span>              <span class="token comment">; acute</span>
#u<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Return</span>              <span class="token comment">; umlaut</span>
#i<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Return</span>              <span class="token comment">; circumflex</span>
#n<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Return</span>              <span class="token comment">; tilde</span>

<span class="token comment">; Lower-case characters that may acquire an accent</span>
<span class="token comment">;</span>
$a<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>aMap<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span>
$e<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>eMap<span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">)</span>
$i<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>iMap<span class="token punctuation">,</span> <span class="token string">"i"</span><span class="token punctuation">)</span>
$o<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>oMap<span class="token punctuation">,</span> <span class="token string">"o"</span><span class="token punctuation">)</span>
$u<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>uMap<span class="token punctuation">,</span> <span class="token string">"u"</span><span class="token punctuation">)</span>
$n<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>nMap<span class="token punctuation">,</span> <span class="token string">"n"</span><span class="token punctuation">)</span>

<span class="token comment">; Upper-case characters that may acquire an accent</span>
<span class="token comment">;</span>
<span class="token operator">+</span>$a<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>aMap<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span>
<span class="token operator">+</span>$e<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>eMap<span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">)</span>
<span class="token operator">+</span>$i<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>iMap<span class="token punctuation">,</span> <span class="token string">"i"</span><span class="token punctuation">)</span>
<span class="token operator">+</span>$o<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>oMap<span class="token punctuation">,</span> <span class="token string">"o"</span><span class="token punctuation">)</span>
<span class="token operator">+</span>$u<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>uMap<span class="token punctuation">,</span> <span class="token string">"u"</span><span class="token punctuation">)</span>
<span class="token operator">+</span>$n<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>nMap<span class="token punctuation">,</span> <span class="token string">"n"</span><span class="token punctuation">)</span>

<span class="token comment">; Possibly apply a diacritic mark to a given character.</span>
<span class="token comment">; map - the mapping of Unicode characters to search in for a dead-key</span>
<span class="token comment">; k - the key that was just typed</span>
<span class="token comment">;</span>
<span class="token function">DoDiac</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token symbol">shiftDown</span> <span class="token operator">:=</span> <span class="token selector">GetKeyState</span><span class="token punctuation">(</span><span class="token string">"Shift"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token operator">.</span><span class="token function">HasKey</span><span class="token punctuation">(</span><span class="token constant">A_PriorHotKey</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">A_TimeSincePriorHotkey</span> <span class="token operator">&lt;</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        key <span class="token operator">:=</span> map<span class="token punctuation">[</span><span class="token constant">A_PriorHotkey</span><span class="token punctuation">]</span>
        c <span class="token operator">:=</span> <span class="token builtin">Chr</span><span class="token punctuation">(</span>key <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token symbol">ShiftDown</span> <span class="token operator">?</span> <span class="token number">0x20</span> <span class="token punctuation">:</span> <span class="token number">0x00</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token selector">SendInput</span> <span class="token punctuation">{</span>Raw<span class="token punctuation">}</span><span class="token variable">%c%</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token symbol">shiftDown</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            k <span class="token operator">:=</span> <span class="token builtin">Chr</span><span class="token punctuation">(</span><span class="token function">Ord</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x20</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token selector">SendInput</span> <span class="token punctuation">{</span>Raw<span class="token punctuation">}</span><span class="token variable">%k%</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>There are basically three parts to the above snippet of AutoHotKey config magic:</p><ol><li>Mapping from <em>dead</em> keys to Unicode characters for each of the vowel characters and the letter <em>n</em></li><li>Defining the <em>dead</em> keys</li><li>Translating a vowel into something else if the previous key press was a dead key</li></ol><p>For instance, the <code>aMap</code> variable holds a mapping from dead key values to Unicode character variations of the letter <em>a</em>. An <em>a</em> with an umlaut over it is obtained by pressing the <code>dead</code> key <em>Win U</em> followed by the <em>a</em> key. (here, <em>Win</em> means the Windows keyboard modifier). There are translations for both lower-case and upper-case vowels and <em>n</em>. They can use the same function <code>DoDiac</code> because the function can determine the state of the <em>Shift</em> key on its own.</p><p>The <code>DoDiac</code> function checks if there is an entry in the given map for the last keystroke seen. If so, then the previous keystroke must have been a dead key. The function then obtains the keystroke to send to Windows, and updates the value if the <em>Shift</em> modifier is pressed. Otherwise, just send an unadorned character to Windows.</p><p>I also added some additional mappings that duplicate those from Mac OS X or come close. These too are obtained using the <em>Win</em> modifier:</p><pre class=language-autohotkey><code class=language-autohotkey>#<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x00A1</span><span class="token punctuation">}</span> <span class="token comment">; ¡ (inverted exclamation mark)</span>
#<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x20AC</span><span class="token punctuation">}</span> <span class="token comment">; € (Euro currency symbol)</span>
#;<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x2026</span><span class="token punctuation">}</span>  <span class="token comment">; … (ellipsis)</span>
#a<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x00E5</span><span class="token punctuation">}</span>  <span class="token comment">; å</span>
#<span class="token operator">+</span>a<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x00C5</span><span class="token punctuation">}</span> <span class="token comment">; Å</span>
#<span class="token operator">+</span>c<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x00C7</span><span class="token punctuation">}</span> <span class="token comment">; Ç</span>
#c<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x00E7</span><span class="token punctuation">}</span>  <span class="token comment">; ç</span>
</code></pre><h2>The Rest of the Story</h2><p>Here’s my whole <a href=AutoHotKey.ahk>AutoHotKey configuration file</a>:</p><pre class=language-autohotkey><code class=language-autohotkey><span class="token important">#SingleInstance</span> Force
<span class="token important">#UseHook</span>

<span class="token comment">; Lookup tables from AHK key descriptors to unicode values</span>
<span class="token comment">;                            à À           á Á           ä Ä           â Â</span>
<span class="token keyword">global</span> aMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#VKC0SC029"</span><span class="token punctuation">:</span> <span class="token number">0x00E0</span><span class="token punctuation">,</span> <span class="token string">"#e"</span><span class="token punctuation">:</span> <span class="token number">0x00E1</span><span class="token punctuation">,</span> <span class="token string">"#u"</span><span class="token punctuation">:</span> <span class="token number">0x00E4</span><span class="token punctuation">,</span> <span class="token string">"#i"</span><span class="token punctuation">:</span> <span class="token number">0x00E2</span><span class="token punctuation">}</span>
<span class="token comment">;                            è È           é É           ë Ë           ê Ê</span>
<span class="token keyword">global</span> eMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#VKC0SC029"</span><span class="token punctuation">:</span> <span class="token number">0x00E8</span><span class="token punctuation">,</span> <span class="token string">"#e"</span><span class="token punctuation">:</span> <span class="token number">0x00E9</span><span class="token punctuation">,</span> <span class="token string">"#u"</span><span class="token punctuation">:</span> <span class="token number">0x00EB</span><span class="token punctuation">,</span> <span class="token string">"#i"</span><span class="token punctuation">:</span> <span class="token number">0x00EA</span><span class="token punctuation">}</span>
<span class="token comment">;                            ì Ì           í Í           ï Ï           î Î</span>
<span class="token keyword">global</span> iMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#VKC0SC029"</span><span class="token punctuation">:</span> <span class="token number">0x00EC</span><span class="token punctuation">,</span> <span class="token string">"#e"</span><span class="token punctuation">:</span> <span class="token number">0x00ED</span><span class="token punctuation">,</span> <span class="token string">"#u"</span><span class="token punctuation">:</span> <span class="token number">0x00EF</span><span class="token punctuation">,</span> <span class="token string">"#i"</span><span class="token punctuation">:</span> <span class="token number">0x00EE</span><span class="token punctuation">}</span>
<span class="token comment">;                            ò Ò           ó Ó           ö Ö           ô Ô</span>
<span class="token keyword">global</span> oMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#VKC0SC029"</span><span class="token punctuation">:</span> <span class="token number">0x00F2</span><span class="token punctuation">,</span> <span class="token string">"#e"</span><span class="token punctuation">:</span> <span class="token number">0x00F3</span><span class="token punctuation">,</span> <span class="token string">"#u"</span><span class="token punctuation">:</span> <span class="token number">0x00F6</span><span class="token punctuation">,</span> <span class="token string">"#i"</span><span class="token punctuation">:</span> <span class="token number">0x00F4</span><span class="token punctuation">}</span>
<span class="token comment">;                            ù Ù           ú Ú           ü Ü           û Û</span>
<span class="token keyword">global</span> uMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#VKC0SC029"</span><span class="token punctuation">:</span> <span class="token number">0x00F9</span><span class="token punctuation">,</span> <span class="token string">"#e"</span><span class="token punctuation">:</span> <span class="token number">0x00FA</span><span class="token punctuation">,</span> <span class="token string">"#u"</span><span class="token punctuation">:</span> <span class="token number">0x00FC</span><span class="token punctuation">,</span> <span class="token string">"#i"</span><span class="token punctuation">:</span> <span class="token number">0x00FB</span><span class="token punctuation">}</span>
<span class="token comment">;                    ñ Ñ</span>
<span class="token keyword">global</span> nMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"#n"</span><span class="token punctuation">:</span> <span class="token number">0x00F1</span><span class="token punctuation">}</span>

<span class="token comment">; Dead keys - don't do anything until something else is typed (VKC0SC029 is the keycode for a back quote)</span>
<span class="token comment">;</span>
#VKC0SC029<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Return</span>          <span class="token comment">; grave</span>
#e<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Return</span>              <span class="token comment">; acute</span>
#u<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Return</span>              <span class="token comment">; umlaut</span>
#i<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Return</span>              <span class="token comment">; circumflex</span>
#n<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Return</span>              <span class="token comment">; tilde</span>

<span class="token comment">; Lower-case characters that may acquire an accent</span>
<span class="token comment">;</span>
$a<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>aMap<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span>
$e<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>eMap<span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">)</span>
$i<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>iMap<span class="token punctuation">,</span> <span class="token string">"i"</span><span class="token punctuation">)</span>
$o<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>oMap<span class="token punctuation">,</span> <span class="token string">"o"</span><span class="token punctuation">)</span>
$u<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>uMap<span class="token punctuation">,</span> <span class="token string">"u"</span><span class="token punctuation">)</span>
$n<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>nMap<span class="token punctuation">,</span> <span class="token string">"n"</span><span class="token punctuation">)</span>

<span class="token comment">; Upper-case characters that may acquire an accent</span>
<span class="token comment">;</span>
<span class="token operator">+</span>$a<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>aMap<span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span>
<span class="token operator">+</span>$e<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>eMap<span class="token punctuation">,</span> <span class="token string">"e"</span><span class="token punctuation">)</span>
<span class="token operator">+</span>$i<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>iMap<span class="token punctuation">,</span> <span class="token string">"i"</span><span class="token punctuation">)</span>
<span class="token operator">+</span>$o<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>oMap<span class="token punctuation">,</span> <span class="token string">"o"</span><span class="token punctuation">)</span>
<span class="token operator">+</span>$u<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>uMap<span class="token punctuation">,</span> <span class="token string">"u"</span><span class="token punctuation">)</span>
<span class="token operator">+</span>$n<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoDiac</span><span class="token punctuation">(</span>nMap<span class="token punctuation">,</span> <span class="token string">"n"</span><span class="token punctuation">)</span>

<span class="token comment">; Possibly apply a diacritic mark to a given character.</span>
<span class="token comment">; map - the mapping of Unicode characters to search in for a dead-key</span>
<span class="token comment">; k - the key that was just typed</span>
<span class="token comment">;</span>
<span class="token function">DoDiac</span><span class="token punctuation">(</span>map<span class="token punctuation">,</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token symbol">shiftDown</span> <span class="token operator">:=</span> <span class="token selector">GetKeyState</span><span class="token punctuation">(</span><span class="token string">"Shift"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>map<span class="token operator">.</span><span class="token function">HasKey</span><span class="token punctuation">(</span><span class="token constant">A_PriorHotKey</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">A_TimeSincePriorHotkey</span> <span class="token operator">&lt;</span> <span class="token number">2000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        key <span class="token operator">:=</span> map<span class="token punctuation">[</span><span class="token constant">A_PriorHotkey</span><span class="token punctuation">]</span>
        c <span class="token operator">:=</span> <span class="token builtin">Chr</span><span class="token punctuation">(</span>key <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token symbol">ShiftDown</span> <span class="token operator">?</span> <span class="token number">0x20</span> <span class="token punctuation">:</span> <span class="token number">0x00</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token selector">SendInput</span> <span class="token punctuation">{</span>Raw<span class="token punctuation">}</span><span class="token variable">%c%</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token symbol">shiftDown</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            k <span class="token operator">:=</span> <span class="token builtin">Chr</span><span class="token punctuation">(</span><span class="token function">Ord</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">0x20</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token selector">SendInput</span> <span class="token punctuation">{</span>Raw<span class="token punctuation">}</span><span class="token variable">%k%</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

#<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x00A1</span><span class="token punctuation">}</span> <span class="token comment">; ¡ (inverted exclamation mark)</span>
#<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x20AC</span><span class="token punctuation">}</span> <span class="token comment">; € (Euro currency symbol)</span>
#;<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x2026</span><span class="token punctuation">}</span>  <span class="token comment">; … (ellipsis)</span>
#a<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x00E5</span><span class="token punctuation">}</span>  <span class="token comment">; å</span>
#<span class="token operator">+</span>a<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x00C5</span><span class="token punctuation">}</span> <span class="token comment">; Å</span>
#<span class="token operator">+</span>c<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x00C7</span><span class="token punctuation">}</span> <span class="token comment">; Ç</span>
#c<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">SendInput</span> <span class="token punctuation">{</span>U<span class="token operator">+</span><span class="token number">0x00E7</span><span class="token punctuation">}</span>  <span class="token comment">; ç</span>

<span class="token comment">; Control-Alt-R -- reload AutoHotKey configuration</span>
<span class="token operator">^</span><span class="token operator">!</span>r<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Reload</span>

<span class="token comment">; Control-Alt-F1 -- start new Cygwin shell</span>
<span class="token operator">^</span><span class="token operator">!</span><span class="token symbol">F1</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">Run</span> C<span class="token punctuation">:</span>\cygwin\bin\mintty<span class="token operator">.</span>exe <span class="token operator">/</span>bin<span class="token operator">/</span>bash <span class="token operator">--</span>login

<span class="token operator">!</span>h<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">WinMinimize</span><span class="token punctuation">,</span> A          <span class="token comment">; Minimize window ala Mac</span>

<span class="token comment">; Flag indicating if we are in Emacs-style select mode</span>
<span class="token keyword">global</span> selectMode <span class="token operator">=</span> <span class="token number">0</span>

<span class="token comment">; If previous hotkey was Control-Return, then just echo the active hotkey</span>
<span class="token comment">; Otherwise, issue the given key sequence, possibly with a shift modifier if</span>
<span class="token comment">; we are selecting text.</span>
<span class="token function">DoSend</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">A_PriorHotKey</span> <span class="token operator">==</span> <span class="token string">"$^Return"</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">A_TimeSincePriorHotKey</span> <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token selector">Send</span><span class="token punctuation">,</span> <span class="token variable">%A_ThisHotKey%</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>selectMode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token selector">Send</span><span class="token punctuation">,</span> <span class="token operator">+</span><span class="token variable">%key%</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token selector">Send</span><span class="token punctuation">,</span> <span class="token variable">%key%</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">; Perform an edit action, and stop selecting characters</span>
<span class="token function">DoEdit</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    selectMode <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token function">DoSend</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">; Perform movement, possibly selecting characters while we are doing it</span>
<span class="token function">DoMove</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">DoSend</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">; Don't perform the following key map if in Emacs or Cygwin terminal window</span>
<span class="token comment">;</span>
<span class="token important">#If</span> <span class="token operator">!</span><span class="token punctuation">(</span><span class="token builtin">WinActive</span><span class="token punctuation">(</span><span class="token string">"ahk_class Emacs"</span><span class="token punctuation">)</span> or <span class="token builtin">WinActive</span><span class="token punctuation">(</span><span class="token string">"ahk_class mintty"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

$<span class="token operator">^</span><span class="token symbol">Space</span><span class="token punctuation">:</span><span class="token punctuation">:</span>selectMode <span class="token operator">=</span> <span class="token number">1</span>     <span class="token comment">; Begin selecting text while moving cursor</span>
$<span class="token operator">^</span><span class="token selector">Return</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token selector">return</span>        <span class="token comment">; Control-Return will pass next hotkey</span>

<span class="token operator">^</span>b<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Left}"</span><span class="token punctuation">)</span>        <span class="token comment">; Previous character</span>
<span class="token operator">^</span>f<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Right}"</span><span class="token punctuation">)</span>       <span class="token comment">; Next character</span>
<span class="token operator">^</span>a<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Home}"</span><span class="token punctuation">)</span>        <span class="token comment">; Beginning of line</span>
<span class="token operator">^</span>e<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{End}"</span><span class="token punctuation">)</span>     <span class="token comment">; End of line</span>
<span class="token operator">^</span>p<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Up}"</span><span class="token punctuation">)</span>      <span class="token comment">; Previous line</span>
<span class="token operator">^</span>n<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Down}"</span><span class="token punctuation">)</span>        <span class="token comment">; Next line</span>
<span class="token operator">!</span>b<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"^{Left}"</span><span class="token punctuation">)</span>       <span class="token comment">; Back word</span>
<span class="token operator">!</span>f<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"^{Right}"</span><span class="token punctuation">)</span>      <span class="token comment">; Forward word</span>
<span class="token operator">^</span>v<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{PgDn}"</span><span class="token punctuation">)</span>        <span class="token comment">; Page down</span>
<span class="token operator">!</span>v<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{PgUp}"</span><span class="token punctuation">)</span>        <span class="token comment">; Page up</span>
<span class="token operator">+</span><span class="token operator">!</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"^{Home}"</span><span class="token punctuation">)</span>      <span class="token comment">; Start of buffer</span>
<span class="token operator">+</span><span class="token operator">!</span><span class="token operator">.</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"^{End}"</span><span class="token punctuation">)</span>       <span class="token comment">; End of buffer</span>

<span class="token operator">^</span>k<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoEdit</span><span class="token punctuation">(</span><span class="token string">"+{End}^x"</span><span class="token punctuation">)</span>      <span class="token comment">; Kill line</span>
<span class="token operator">^</span>d<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoEdit</span><span class="token punctuation">(</span><span class="token string">"{Delete}"</span><span class="token punctuation">)</span>      <span class="token comment">; Delete next character</span>

<span class="token operator">^</span>g<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoEdit</span><span class="token punctuation">(</span><span class="token string">"{Esc}"</span><span class="token punctuation">)</span>     <span class="token comment">; Stop</span>
<span class="token operator">!</span>w<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoEdit</span><span class="token punctuation">(</span><span class="token string">"^c"</span><span class="token punctuation">)</span>        <span class="token comment">; Copy selected text</span>
<span class="token operator">^</span>w<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoEdit</span><span class="token punctuation">(</span><span class="token string">"^x"</span><span class="token punctuation">)</span>        <span class="token comment">; Cut selected text</span>
<span class="token operator">^</span>y<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoEdit</span><span class="token punctuation">(</span><span class="token string">"^v"</span><span class="token punctuation">)</span>        <span class="token comment">; Paste from clipboard</span>

$<span class="token symbol">Left</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Left}"</span><span class="token punctuation">)</span>     <span class="token comment">; Previous character (possibly selected)</span>
$<span class="token symbol">Right</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Right}"</span><span class="token punctuation">)</span>   <span class="token comment">; Next character (possibly selected)</span>
$<span class="token symbol">Up</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Up}"</span><span class="token punctuation">)</span>     <span class="token comment">; Previous line (possibly selected)</span>
$<span class="token symbol">Down</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"{Down}"</span><span class="token punctuation">)</span>     <span class="token comment">; Next line (possibly selected)</span>
$<span class="token symbol">Home</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"^{Home}"</span><span class="token punctuation">)</span>    <span class="token comment">; Beginning of buffer (possibly selected)</span>
$<span class="token symbol">End</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoMove</span><span class="token punctuation">(</span><span class="token string">"^{End}"</span><span class="token punctuation">)</span>      <span class="token comment">; End of buffer (possibly selected)</span>

$<span class="token operator">^</span>_<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoEdit</span><span class="token punctuation">(</span><span class="token string">"^z"</span><span class="token punctuation">)</span>       <span class="token comment">; Undo last edit</span>
<span class="token operator">^</span>h<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">DoEdit</span><span class="token punctuation">(</span><span class="token string">"{F1}"</span><span class="token punctuation">)</span>      <span class="token comment">; Show help screen</span>
</code></pre></section><footer class=post-footer><figure class=author-image><a class=img href=https://keystrokecountdown.com style=background-image:url(/images/HarrisonsLaugh.png)><span class=hidden>Brad Howes's Picture</span></a></figure><section class=author><h4><a href=https://keystrokecountdown.com>Brad Howes</a></h4><p>Owner <a href=https://apps.apple.com/us/developer/b-ray-software/id430573224>B-Ray Software</a>. Programmer in C++, Swift, Python, Javascript and more. Started out doing punch cards in FORTRAN.</p><div class=author-meta><span class="author-location icon-location">Paris, France</span> <span class="author-link icon-link"><a href=http://linkedin.com/in/bradhowes>http://linkedin.com/in/bradhowes</a></span> <span class="author-link icon-feed"><a href=mailto:bradhowes@mac.com>&nbsp;Email Me</a></span></div></section><section class=share><h4>Share this page</h4><div class=social-icons><a class=icon-twitter href="https://twitter.com/intent/tweet?text=Different%20(Key)strokes%20for%20Different%20Folks&amp;url=https%3A%2Fkeystrokecountdown.com%2Farticles%2Fautohotkey%2Findex.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"><span class=hidden>Twitter</span> </a><a class=icon-feed href="mailto:bradhowes@mac.com?subject=Curiosity&body=https%3A%2Fkeystrokecountdown.com%2Farticles%2Fautohotkey%2Findex.html"><span class=hidden>Email</span></a></div></section></footer></article></main><aside class=read-next><a class=read-next-story style="background-image: url(/articles/itunes/image.png)" href=/articles/itunes/index.html><section class=post><h2>Apple iTunes Library Manipulation with Python</h2><div class=post-meta>Short discussion on using Python to manipulate the contents of an iTunes Library XML file.</div></section></a><a class="read-next-story prev" style="background-image: url(/articles/docker/docker.png)" href=/articles/docker/index.html><section class=post><h2>[DRAFT] Playing with .Net Core Apps and Docker on a Mac</h2><div class=post-meta>A brief look at using Docker containers to run a C# app</div></section></a></aside><footer class="site-footer clearfix"><section class=copyright><a href=https://keystrokecountdown.com>Keystroke Countdown</a> &copy; <span id=copyrightYear>2017</span> Brad Howes — <a href=https://github.com/bradhowes/keystrokecountdown>Source</a></section></footer></div><script>(function () {
      var installClickHandlers = function () {
        var navElement = document.getElementById("nav");
    
        // The click handler just toggles classes to do the showing/hiding
        //
        var clickHandler = function(e) {
          document.body.classList.toggle("nav-opened");
          document.body.classList.toggle("nav-closed");
          if (navElement) {
            navElement.classList.toggle("nav-opened");
            navElement.classList.toggle("nav-closed");
          }
        };
    
        // Find elements we wish to tap for click events
        //
        var elements = Array.prototype.slice.call(
          document.querySelectorAll(".menu-button, .nav-cover, .nav-close"));
        if (elements && elements.length > 0) {
          elements.forEach(function (element) {
            element.addEventListener('click', clickHandler);
          });
        }
      };
    
      // When the document is finished loading, install event handlers to show/hide sidebar menu
      //
      window.document.addEventListener("DOMContentLoaded", function (event) {
        installClickHandlers();
    
        // Set the copyright year at the bottom of our pages
        //
        window.document.getElementById("copyrightYear").innerHTML = (new Date()).getFullYear();
      });
    })();</script></body></html>